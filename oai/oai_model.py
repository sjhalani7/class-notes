from typing import List
from openai import OpenAI
import configs.api_keys as config
from pydantic import BaseModel


client = OpenAI(api_key=config.open_ai_api_key)
PROMPT_FILE = "oai/developer_prompt.txt"

class Subtopic(BaseModel):
    subtopic_title:str
    subtopic_body: List[str]


class Topic(BaseModel):
    title:str
    subtopics:List[Subtopic]


class DocumentText(BaseModel):
    topics:List[Topic]


def query_text_model(question_query:str) -> DocumentText:
    with open(PROMPT_FILE, 'r') as file:  
        developer_query = file.read()
    
    completion = client.beta.chat.completions.parse(
    model="gpt-4o-2024-08-06",
    messages = [
        {"role": "developer", "content": f"{developer_query}"},
        {
            "role": "user",
            "content": f"{question_query}"
        }
    ],
    response_format=DocumentText,
    )
    return completion.choices[0].message.parsed

def query_whisper(audio_file_path:str) -> str:
   audio_file = open(audio_file_path, "rb")
   transcription = client.audio.transcriptions.create(
    model="whisper-1", 
    file=audio_file
   )
   return transcription.text   
   sample = """
        So all these structures are going to have this individual orientation of the ears. Okay, next up is the lemuriform. Lemuriform are the infraorder for all lemurs. This is of course, best movie ever, just so you remember, Lemur, Madagascar, they're only found in Madagascar. Only found in Madagascar, right? King Julian, Mort, and Maurice. Yesterday you saw Maurice in Latin. The guy that looks like, the guy that looks like he's got a bow and teeth, that's Maurice. FYI. And in real life he looks quite a bit like Maurice. Alright. So this is also a type of strep serine? Absolutely. Like an infraorder? Correct. That's why I have it as a suborder and an infraorder. You're going to find that as I introduce new animals, I will have the suborder, the infraorder, and then it gets worse as the slides go through. Okay, so be forewarned. Of all strep serines, lemurs are the most diverse. The most diverse. Lemurs are also sequestered on an island, right? They're found in Madagascar. The diversification of these animals is the result of primates jumping from, jumping from, rafting from, or getting to the islands of Madagascar about 55 million years ago. And they found on this island, in this new ecological niche, they found an open space available to them, where they, these primates that made it to Madagascar, then were able to exploit these new ecological niches, right, and acquire adaptations, acquire adaptations, or adapt to these different ecological environments. Madagascar can be really cold and can be really hot. It has a lot of mountain ranges. So every, those strep serines have evolved in different ecological contexts within a very small, very small area. It's a small area relative to Africa. So when their ancestors go to Madagascar, they find less predation, or little to no predation, little to no predation. They find new ecological resources, a new ecological context, where they can exploit food, water, shelter, and any behavior that will give them access to these resources. So these primates, 55 million years ago, go to Madagascar, right? What is now Madagascar. And by the way, 55 million years ago, Madagascar was an island. It wasn't linked to mainland Africa. So they find this new ecology, and because predation is low, and there's a lot of food available, diversification increases, where animals adapt to either highlands, lowlands, warm areas, colder areas, etc. And that is possible due to something called relaxed selection. Relaxed selection is natural selection that is not very, that is not intense, and is not intensively acting on individuals because of these brand new ecological contexts. And as such, animals can then exploit the resources in these contexts as easily and energetically efficient as possible. So it's not that these animals are adapting to, are perfectly adapting to the environment, no, or just coming up with different solutions in these ecological contexts, but rather, relaxed selection gives rise to, or can give rise to, traits and alternate traits. When those traits become problematic to the survival of the individual, or when those traits become beneficial to the survival of the individual, then natural selection kicks in and becomes really intense. And so at that point, selection is relaxed. So anything, any trait can pop up. It's really important. What we're going to see with lemurs is a very, very, very, very different animal. Yes, there's the relaxed selection habit, because there's not very many predators in the ecological context. Right, exactly. Exactly. All right, so lemurs. Lemurs can be either nocturnal or diurnal, but they're typically diurnal. They can be really large. They can also lack tails. This is an injury, and it is a large animal who lacks tails, right, who lacks a tail. In terms of eyes, they have small eyes, yet they have large ears. This is something weird. If nocturnal animals have large eyes and large ears, then shouldn't diurnal animals have small eyes, which we do, and small ears? No, we don't. We have large ears relative to our head size, and yet we have little tiny eyes. These guys, the diurnal ones, have small eyes, and yet they have large ears, suggesting that they still rely on hearing as well as vision. We, however, rely more on vision than on hearing. Some of these animals, some of these lemurs, lemurs in general, will be either solitary social systems. You know what that means. When I say social systems, you have to immediately think of the social organization, the social structure, and the naming system. They're three very different things. So lemurs will be either solitary or they will live in groups. There's a single male polygyny or a multi-male polygyny. Some lemurs are going to be very large, and some are going to be tiny, tiny, tiny, tiny, tiny. That's where more comes in. In terms of diet, polypory, porgypory, insectivory. This is a chain of species of lemurs. Yes, we have a female here and a male here. These two, the sexual diatropotism, is something that we're going to find in lemurs as well as in some in one half of the line. So six species, they just go to the heart. And here's mort. Mort is a mouse lemur. It is the smallest primate in the world. The smallest, smallest primate in the world. It is a nocturnal animal, huge eyes, huge ears. Mort is amazing. Poor Mort. He always got the bad end of the deal. Poor guy. But it's okay, Mort. You survived. Preserved everything. Like a strep serine, globular fingertips, right? What it knows of the binarium, all the strep serine features. What is cool about him is that he's just so cute. Okay, see the globular fingertips? And look at the curvature of these hands, right? Look at the curved fingers. This guy does not flatten out his hands when he walks. And the vertical clinger on these, he's so tiny. I want to give him kisses. But you can't do that to this guy. And also to all the animals. So there's a video here. There's a PDF that I made of a primate video. I provided that PDF for a reason. Those examples are going to come up on the text. So the smallest, smallest, smallest lemur. So let's find out a little bit about this guy. So these individuals will live to about 18 years in the wild. So they don't have a long lifespan when you compare it to hapermites. Hapermites can live up to 40, 50 years in the wild. Mouse lemurs can live up to about 18 years in the wild. Of course, if they're in captivity, they will live longer, right? Because they have access to medical resources. Captivity, I'm sorry. In zoological museums, under the correct type of captivity, when they have a demand to medical care, et cetera.
        Add these notes

        Alright, now we're going to go to the other infra-order, semi-informed. So this is the infra-order for semi-informed, this is for semi-informed. Semi-informed have two hard orders, catariding and flatteriding. This is what we're looking at. So semi-informed, we're going to hit flatteriding. And flatterides are going to be our new world market, only our new world market. And again, remember you're getting these slides, you're getting the outlines of these slides, you're going to get these little maps, these little taxonomies. Alright, so these are flatterides. Semi-informed, hard order, catariding. Flatteride locomotion is quite varied. Flatterides are going to be arboreal quadrupeds. Flatterides are only arboreal quadrupeds. They will locomote up on trees 99.9% of the time, they will come down on the ground because they want to, but they're going to locomote, they're going to be active, they're going to forage, they're going to nest, they're going to have sex, they're going to party up on trees. So they are 99.99% arboreal quadrupeds. Within this arboreal quadrupedalism, there's also going to be a few, a few, a few, a few individuals, or a class, a T-list, spider monkey, holler monkey, and chip. These guys, they're going to have something called a prehensile tail. Did any of you watch the video of the spider monkey that I put on Camino? Anybody? Anyway, the prehensile tail is this. It's a beautiful, long tail that helps them hang from a branch. The prehensile tail is a hanging feature, it's like another limb. No other, so besides these, besides Attilus, no other flutter line is going to hang. Only Attilus hangs from their tail. Their tail is specialized, incredibly muscular, very fatty, and the tip, the underside of the tip of the tail does not have any fur. It is used as a feeding mechanism, or it is used to help in feeding. Attilus are proliferate, yes, which means that they are larger than proliferate. And to get access to the nice white fruit that's usually in the tip of branches, they are going to wrap their tails around the branch and access that food resource. They are called also, or the use of the prehensile tail is a type of brachiation called steady brachiation. Brachiation is defined as swinging arm over arm under branches. That's what we do, that's what we apes do. We apes swing arm over arm under branches. These guys will swing just a little bit, but they will use their tail as the brachiation component. So, Attilus have our steady brachiators. And this is what it looks like, this is what the prehensile tail looks like. See how the underside of that tail, the tip of the underside of that tail doesn't have any fur? That is what gives you that beautiful gripping friction. So, only Attilus, this is a red hover monkey, and this is what you can sort of see the prehensile, the exposed skin right here. Very fatty, very muscular tail. Diets. Plateroids, diet, and dentition. Plateroids is what I love. It's a 2-1-3-3 dental formula. Most plateroids are going to be glutubores. So, they're going to have broad incisors, low rounded cuffs for finding that beautiful groove, and a really long, small intestine to digest that very highly nutritious food. Some plateroids are going to incorporate gum in their diet, right? So, some plateroids are going to consume gum. Many plateroids are also going to incorporate seeds, or bees, insects. Incorporate. This is what they're going to emphasize. Some plateroids are going to eat frogs, or small birds, maybe eggs in their diet. Very much like what we see in tarsiers. Tarsiers. The diet of a tarsier is carnivory. Tarsiers are not insectivores. They are not omnivores. Omnivores, they are freaking carnivorous. Okay, and some insects. Yes, fine, and some insects. They are carnivorous because they are the only... They're the only... If you were a proscenium, it's the only proscenium to eat vertebrates. Prosceniums do not eat vertebrates. If a tarsier is considered a proscenium, then it's the only proscenium to eat vertebrates. Frogs, lizards, salamanders. But, it's a herbarium, so carnivory is not on her diet. Okay. Social systems. There's going to be a lot of social systems with these guys. But most flatirons... We've got one minute. This is awesome. Flatirons, but most flatirons are going to live in large, multi-male, multi-female, proglygianous groups. There's going to be a few single male proglygianous groups. And there will be very slight sexual dimorphism. Very slight sexual dimorphism. Because you are an arboreal animal, there cannot be one sex that's incredibly big and the other sex that is not as big. So the body sizes of both males and females will be about the same
    """
   
   return sample





# print(query_text_model(sample))